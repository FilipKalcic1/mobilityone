````markdown
# MobilityOne Fleet AI

WhatsApp mikroservis za upravljanje voznim parkom. Dokument služi kao sažeta tehnička uputa za konfiguraciju, pokretanje i održavanje sustava.

---

## Značajke

* Semantički router za dinamičko pronalaženje relevantnih API operacija putem vektorske pretrage OpenAPI definicije.
* Sigurnosni sloj koji zahtijeva izričitu potvrdu korisnika prije izvršavanja POST/DELETE operacija.
* Asinkrona obrada poruka putem Redis workera; webhook služi isključivo za prijem.
* API-agnostičan rad kroz učitavanje `swagger.json` datoteke.
* Dead Letter Queue i korisnički rate-limiting radi stabilnosti sustava.

---

## Tehnološki stack

* Python 3.11 + FastAPI  
* Redis 7  
* OpenAI GPT modeli + embeddings  
* Infobip WhatsApp API  

---

## Konfiguracija (.env)

Kreirati `.env` datoteku u korijenu:

```bash
APP_ENV=production
REDIS_URL=redis://redis:6379

# AI
OPENAI_API_KEY=sk-...

# Infobip (WhatsApp)
INFOBIP_BASE_URL=xxxxx.api.infobip.com
INFOBIP_API_KEY=...
INFOBIP_SENDER_NUMBER=...
INFOBIP_SECRET_KEY=...

# Backend API
MOBILITY_API_URL=https://api.mobilityone.com/v1
````

---

## Preduvjeti

U korijenu mora postojati `swagger.json` s OpenAPI specifikacijom backend sustava.

---

## Pokretanje

```bash
docker-compose up --build --scale worker=5
```

Aplikacija: `http://localhost:8000`
Health check: `http://localhost:8000/health`

---

## Struktura projekta

```text
mobilityone/
├── main.py                # Ulazna točka sustava
├── worker.py              # Asinkroni obrađivač poruka
├── swagger.json           # OpenAPI definicija
├── routers/               # Webhook endpointi
├── services/
│   ├── tool_registry.py   # Vektorska pretraga alata
│   ├── openapi_bridge.py  # Dinamički API klijent
│   ├── ai.py              # AI logika i sigurnosni sloj
│   ├── queue.py           # Redis queue i DLQ
│   └── context.py         # Sliding-window kontekst
└── docker-compose.yml     # Infrastruktura
```

```
```
